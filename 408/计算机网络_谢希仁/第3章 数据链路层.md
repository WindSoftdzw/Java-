# 第3章 数据链路层

数据链路层属于计算机网络的底层。数据链路层使用的信道主要有以下两种类型：

1. **点对点信道**	这种信道使用一对一的点对点通信方式
2. **广播信道**	这种信道使用一对多的广播通信方式，因此过程比较复杂。广播信道上连接的主机很多，因此必须使用专用的共享信道协议来协调这些主机的数据发送。

## 1.使用点对点信道的数据链路

### 1.1数据链路和帧

所谓**链路**就是从一个结点**到相邻结点**的一段物理线路（有线或无线），而中间没有任何其他的交换节点。

**数据链路**（data link）则是另一个概念。若把实现一些必要的控制数据传输的通信协议的硬件和软件加到链路上，就构成了数据链路。

数据链路层把网络层交下来的数据构成**帧**发送到链路上，以及把接收到的**帧**中的数据取出并上交给网络层。在因特网中，网络层协议数据单元就是IP数据报。

点对点信道的数据链路层在进行通信时的主要步骤如下：

1. 结点A的数据链路层把网络层交下来的IP数据报添加首部和尾部封装成帧。
2. 结点A把封装好的帧发送给结点B的数据链路层。
3. 若结点B的数据链路层收到的帧无差错，则从收到的帧中提取出IP数据报上交给上面的网络层；否则丢弃这个帧。

数据链路层不必考虑物理层如何实现比特传输的细节。我们甚至还可以更简单地设想**好像是**沿着两个数据链路层之间的水平方向把帧直接发送到对方。

### 1.2三个基本问题

数据链路层协议有许多种，但有三个基本问题则是共同的。这三个基本问题就是：**封装成帧**、**透明传输**、和**差错检测**。

#### （1）封装成帧

**封装成帧**（framing）就是在一段数据的前后分别添加首部和尾部，这样就构成了一个帧。接收端在收到物理层上交的比特流后，就能根据首部和尾部的标记，从收到的比特流中识别帧的开始和结束。一个帧的帧长等于帧的数据部分长度加上帧首部和帧尾部的长度。首部和尾部的一个重要作用就是进行**帧定界**。在发送帧时，是从帧首部开始发送。为了提高帧的传输效率，应当使帧的数据部分长度尽可能地大于首部和尾部的长度。但是每一种链路层协议都规定了所能传送的帧的**数据部分长度上限——传送单元MTU**（Maximum Transfer Unit）。

当数据是由可打印的ASCII码组成的文本文件时，帧定界可以使用特殊的**帧定界符**。

#### （2）透明传输

由于帧的开始和结束的标记是使用专门指明的控制字符，因此，所传输的数据中的任何8比特的组合不允许和用作帧定界的控制字符的比特编码一样，否则就会出现帧定界的错误。

但当数据部分是非ASCII码的文本文件时，情况就不同了。如果数据中的某个字节的二进制代码恰好和SOH或EOT这样的帧定界控制字符一样，数据链路层就会**错误地**“找到帧的边界”，把部分帧收下，而把剩下的那部分数据丢弃。

“**透明**”是一个很重要的术语。它表示：**某一个实际存在的事物看起来却是好像不存在一样**。“在数据链路层透明传送数据”表示无论什么样的比特组合的数据都能够通过这个数据链路层。

为了解决透明传输问题，就必须设法使**数据中**可能出现的控制字符“SOH”和“EOT”在接收端不被解释为控制字符。具体的方法是：发送端的数据链路层在数据中出现控制字符“SOH”和“EOT”的前面插入一个**转义字符**“ESC”。而在接收端的数据链路层在把数据送往网络层之前删除这个插入的转义字符。这种方法称为**字节填充**或**字符填充**。如果转义字符也出现在数据当中，那么解决方法仍然是在转义字符的前面插入一个转义字符。因此，当接收端收到连续的两个转义字符时，就删除其中最前面的一个。

#### （3）差错检测

比特在传输过程中可能会产生差错：1可能会变成0，而0也可能变成1.这就叫做“**比特差错**”。在一段时间内，传输错误的比特总数的比率称为**误码率BER**（Bit Error Rate）。误码率与信噪比有很大的关系。如果设法提高信噪比，就可以使误码率减小。实际的通信链路并非是理想的，它不可能使误码率下降到零。因此，为了保证数据传输的可靠性，在计算机网络传输数据时，必须采用各种差错检测措施。目前在数据链路层广泛使用了**循环冗余检验CRC**的检错技术。

n位冗余码可用以下方法得出。用二进制的**模2运算**进行$2^n$乘数据M的运算，这相当于在数据M后面添加n个0。得到的(k+n)位的数**除以**双方事先商定的长度为(n+1)位的除数P，得出商是Q而**余数**是R。关于除数P下面还要介绍。这个余数R就作为冗余码拼接在数据M的后面发送出去。这种为了进行检错而添加的冗余码常称为**帧检验序列FCS**（Frame Check Sequence）。

在接收端把接收到的数据以帧为单位进行CRC检验：把收到的每一个帧都除以同样的除数P，然后检查得到的余数R。如果在传输过程中无差错，那么经过CRC检验后得出的余数R肯定是0。

总之，在接收端对收到的每一帧经过CRC检验后，有以下两种情况：

（1）若得出的余数R = 0，则判定这个帧没有差错，就接受。

（2）若余数R $\neq$ 0，则判定这个帧有差错，就丢弃。

一种较方便的方法是用多项式来表示循环冗余检验过程。在上面的例子中，用多项式$P(x) = X^3 + X^2 + 1$表示上面的除数P=1101.多项式P(x)称为**生成多项式**。现广泛使用的生成多项式P(x)有以下几种：

$CRC-16 = X^{16} + X^{15}+ x^2 +1$

$CRC-CCITT = X^{16} + X^{12} + X^5 + 1$

$CRC-32 = X^{32} + X^{26} + X^{23} + X^{22} + X^{16} + X^{12} + X^{11} + X^{10} + X^8+X^7+X^5+X^4+X^2+X+1$

在数据链路层若**仅仅**使用循环冗余检验CRC差错检测技术，则只能做到对帧的**无差错接受**，即：“**凡是接收端数据链路层接受的帧，我们都能以非常接近于1的概率认为这些帧在传输过程中没有产生差错**”。接收端丢弃的帧虽然曾**收到**了，但最终还是因为有差错被丢弃，即没有被**接受**。以上所述的可以**近似地**表述为：“**凡是接收端数据链路层接受的帧均无差错**”。

所谓“可靠传输”就是：数据链路层的发送端发送什么，在接收端就收到什么。传输差错可分为两大类：一类就是前面所说的最基本的比特差错，而另一类传输差错则更复杂些，这就是收到的帧并没有出现比特差错，但却出现了**帧丢失、帧重复**或**帧时序**。

“无比特差错”与“五传输差错”并不是同样的概念。**在数据链路层使用CRC检验，能够实现无比特差错的传输，但这还不是可靠传输。**

## 2.点对点协议PPP

### 2.1PPP协议的特点

#### 1.PPP协议应满足的需求

IETF认为，在设计PPP协议时必须考虑以下多方面的需求：

1. **简单**	IETF在设计因特网体系结构时把其中最复杂的部分放在TCP协议中，而网际协议IP则相对比较简单，它提供的是不可靠的数据报服务。在这种情况下，数据链路层没有必要提供比IP协议更多的功能。因此，对数据链路层的帧，不需要纠错，不需要序号，也不需要流量控制。IETF把“简单”作为**首要的需求**。

   简单的设计还可使协议在实现时不容易出错，从而使不同厂商在协议的不同实现上其**互操作性提高了**。我们知道，协议标准化的一个主要目的就是提高协议的互操作性。

   总之，这种数据链路层的协议非常简单：接收方每收到一个帧，就进行CRC检验。如CRC检验正确，就收下这个帧；反之，就丢弃这个帧，**其他什么也不做**。

2. **封装成帧**	PPP协议必须规定特殊的字符作为**帧定界符**，以便使接收端从收到的比特流中能准确地找出帧的开始和结束位置。

3. **透明性**	PPP协议必须保证数据传输的透明性。这就是说，如果数据中碰巧出现了和帧定界符一样的比特组合时，就要采取有效的措施来解决这个问题。

4. **多种网络层协议**	PPP协议必须能够在**在同一条物理链路上同时支持多种网络层协议**的运行。当点对点链路所连接的是局域网或路由器时，PPP协议必须同时支持在链路所连接的局域网或路由器上运行的各种网络层协议。

5. **多种类型链路**	除了要支持多种网络层的协议外，PPP还必须能够在多种类型的链路上运行。

6. **差错检测**	PPP协议必须能够对接收端收到的帧进行检测，并**立即丢弃有差错的帧**。若在数据链路层不进行差错检测，那么已出现差错的无用帧就还要再网络继续向前转发，因而会白白浪费许多的网络资源。

7. **检查连接状态**	PPP协议必须具有一种机制能够及时自动检测出链路是否处于正常工作状态。当出现故障的链路隔了一段时间后又重新恢复正常工作时，就特别需要有这种及时检测功能。

8. **最大传送单元**	PPP协议必须对每一种类型的点对点链路设置**最大传送单元MTU**的标准默认值。这样做是为了促进各种实现之间的互操作性。如果高层协议发送的分组过长并超过MTU的数值，PPP就就丢弃这样的帧，并返回差错。需要强调的是，MTU是数据链路层的帧可以载荷的**数据部分**的最大长度，而**不是帧的总长度**。

9. **网络层地址协商**	PPP协议必须提供一种机制使通信的两个网络层的实体能够通过协商知道或能够配置彼此的网络层地址。协商的算法应尽可能简单，并且能够在所有的情况下得出协商结果。这对拨号连接的链路特别重要，因为仅仅在链路层建立了连接而不知道对方网络层地址时，则还不能够保证网络层可以传送分组。

10. **数据压缩协商**	PPP协议必须提供一种方法来协商使用数据压缩算法。但PPP协议并不要求将数据压缩算法进行标准化。

    在TCP/IP协议族中，可靠传输由运输层的TCP协议负责，因此数据链路层的PPP协议不需要进行纠错，不需要设置序号，也不需要进行流量控制。PPP协议不支持多点线路，而只支持点对点的链路通信。此外，PPP协议只支持全双工链路。

#### 2.PPP协议的组成

PPP协议有三个组成部分：

1. 一个将IP数据报封装到串行链路的方法。PPP既支持异步链路，也支持面向比特的同步链路。IP数据报在PPP帧中就是其信息部分。这个信息部分的长度受到最大传送单元MTU的限制。
2. 一个用来建立、配置和测试数据链路连接的**链路控制协议ICP**。
3. 一套**网络控制协议NCP**，其中的每一个协议支持不同的网络层协议。

### 2.2PPP协议的帧格式

#### 1.各字段的意义

PPP帧的首部和尾部分别为四个字段和两个字段。

首部的第一个字段和尾部的第二个字段都是标志字段F（Flag），规定为0x7E。标志字段表示一个帧的开始或结束。因此标志字段就是PPP帧的定界符。连续两帧之间只需要用一个标志字段。如果出现连续两个标志字段，就表示这是一个空帧，应当丢弃。

首部中的地址字段A规定为0xFF，控制字段C规定为0x03。

PPP首部的第四个字段是2字节的协议字段。

信息字段的长度是可变的，不超过1500字节。

尾部中的第一个字段是使用CRC的帧检验序列FCS。

#### 2.字节填充

当信息字段中出现和标志字段一样的比特组合时，就必须采取一些措施使这种形式上和标志字段一样的比特组合不出现在信息字段中。

当PPP使用异步传输时，它把转义符定义为0x7D，并使用**字节填充**，RFC1662规定了如下所述的填充方法：

1. 把信息字段中出现的每一个0x7E字节转变为2字节序列（0x7D，0x5E）。
2. 若信息字段中出现一个0x7D的字节，则把0x7D转变为2字节序列（0x7D，0x5D）。
3. 若信息字段中出现ASCII码的控制字符，则在该字符前面要加入一个0x7D字节，同时将该字符的编码加以改变。

#### 3.零比特填充

PPP协议用在SONET/SDH链路时，是使用同步传输而不是异步传输。在这种情况下，PPP协议采用零比特填充方法来实现透明传输。

零比特填充的做法是：在发送端，先扫描整个信息字段。只要发现有5个连续1，则立即填入一个0。因此经过这种零比特填充后的数据，就可以保证在信息字段中不会出现6个连续1。接收端在收到一个帧时，先找到标志字段F以确定一个帧的边界，接着再用硬件对其中的比特流进行扫描。每当发现5个连续1时，就把这5个连续1后的一个0删除，以还原成原来的信息比特流。这样就保证了透明传输：在所传送的数据比特流中可以传送任意组合的比特流，而不会引起对帧边界的判断错误。

### 2.3PPP协议的工作状态

PPP协议的起始和终止状态永远是“**链路静止**”状态，这时在用户PC和ISP的路由器之间并不存在物理层的连接。

当用户PC通过调制解调器呼叫路由器时，路由器就能够检测到调制解调器发出的载波信号。在双方建立了物理层连接后，PPP就进入“**链路建立**”状态，其目的是建立链路层的LCP连接。

这时LCP开始协商一些**配置选项**，即发送LCP的**配置请求帧**。这是个PPP帧，其协议字段置为LCP对应的代码，而信息字段包含特定的配置请求。链路的另一端可以发送以下几种响应中的一种：

1. **配置确认帧**：所有选项都接受。
2. **配置否认帧**：所有选项都理解但不能接受。
3. **配置拒绝帧**：选项有的无法识别或不能接受，需要协商。

LCP配置选项包括链路上的最大帧长、所使用的**鉴别协议**的规约，以及不使用PPP帧中的地址和控制子弹。

协商结束后双方就建立了LCP链路，接着就进入“**鉴别**”状态。在这一状态，只允许传送LCP协议的分组、鉴别协议的分组以及监测链路质量的分组。若使用**口令鉴别协议PAP**，则需要发起通信的一方发送身份标识符和口令。系统可允许用户重试若干次。如果需要有更好的安全性，则可使用更加复杂的**口令握手鉴别协议CHAP**。若鉴别身份失败，则转到”**链路终止**“状态。若鉴别成功，则进入“**网络层协议**”状态。

在“**网络层协议**”状态，PPP链路的两端的网络控制协议NCP根据网络层的不同协议互相交换网络层特定的网络控制分组。这个步骤是很重要的，因为现在的路由器都能够同时支持多种的网络层协议。总之，PPP协议两端的网络层可以运行不同的网络层协议，但仍然可以使用同一个PPP协议。

当网络层配置完毕后，链路就进入可进行数据通信的“**链路打开**”状态。链路的两个PPP端点可以彼此向对方发送分组。两个PPP端点还可发送**回送请求LCP**分组和**回送回答LCP**分组，以检查链路的状态。

数据传输结束后，可以由链路的一端发出**终止请求LCP**分组请求终止链路连接，在收到对方发来的**终止确认LCP**分组后，转到“**链路终止**”状态。如果链路出现故障，也会从“**链路打开**”状态转到“**链路终止**”状态。当调制解调器的载波停止后，则回到“**链路静止**”状态。

## 3.使用广播信道的数据链路层

### 3.1局域网的数据链路层

局域网的最主要的**特点**是：**网络为一个单位所拥有，且地理范围和站点数目均有限**。

局域网具有如下的一些主要优点：

1. 具有广播功能，从一个站点可很方便地访问全网。局域网上的主机可共享连接在局域网上的各种硬件和软件资源。
2. 便于系统的扩展和逐渐地演变，各设备的位置可灵活调整和改变。
3. 提高了系统的可靠性、可用性和生存性。

共享信道要着重考虑的一个问题就是如何使众多用户能够合理而方便地共享通信媒体资源。：

1. **静态划分信道**：用户只要分配到了信道就不会和其他用户发生冲突。但这种划分信道地方法代价较高，不适合用于局域网使用。
2. **动态媒体接入控制**：它又称为**多点接入**，其特点使信道并非在用户通信时固定分配给用户。这里又分为以下两类：
   1. **随机接入**	随机接入地特点是所有的用户可随机地发送信息。但如果恰巧有两个或更多的用户在同一时刻发送信息，那么在共享媒体上就要产生**碰撞**，使得这些用户的发送都是被。因此，必须有解决碰撞的网络协议。
   2. **受控接入**	受控接入的特点是用户不能随机地发送信息而必须服从一定的控制。这类典型代表有分散控制的令牌环局域网和集中控制的多点线路**探询**或称为**轮询**。

#### 1.以太网的两个标准 

为了使数据链路层能更好的适应多种局域网标准。IEEE802把局域网的数据链路层拆成两个子层，即**逻辑链路控制LLC**子层和**媒体接入控制MAC**子层。与接入到传输媒体有关的内容都放在MAC子层，而LLC子层则与传输媒体无关，不管采用何种传输媒体和MAC子层的局域网对LLC子层来说都是透明的。

目前逻辑链路控制子层LLC的作用已经消失了。

#### 2.适配器的作用

计算机与外界局域网的连接是通过通信**适配器**。

适配器和局域网之间的通信是通过电缆或双绞线以串行传输方式进行的，而适配器和计算机之间的通信则是通过计算机主板上的I/O总线以并行传输方式进行的。因此，适配器的一个重要功能就是要进行数据串行传输和并行传输的转换。由于网络上的数据率和计算机总线上的数据率并不相同，因此在适配器中必须装有对数据进行缓存的存储芯片。若在主板上插入适配器时，还必须把管理该适配器的设备驱动程序安装在计算机的操作系统中。这个驱动程序以后就会告诉适配器，应当从存储器的什么位置上把多长的数据块发送到局域网，或者应当在存储器的什么位置上把局域网传送过来的数据块存储下来。适配器还要能够实现以太网协议。

适配器接收和发送各种帧时不使用计算机的CPU。这时CPU可以处理其他任务。当适配器收到有差错的帧时，就把这个帧丢弃而不必通知计算机。当适配器收到正确的帧时，它就使用中断来通知该计算机并交付协议栈中的网络层。当计算机要发送到IP数据报时，就由协议栈把IP数据报向下交给适配器，组装成帧后发送到局域网。

### 3.2CSMA/CD协议

最早的以太网将许多计算机都连接在一根总线上。

总线的特点是：当一台计算机发送数据时，总线上的所有计算机都能检测到这个数据。这就是广播通信方式。

为了通信的简便，以太网采取了以下两种措施：

1. 采用较为灵活的**无连接**的工作方式，即不必先建立连接就可以直接发送数据。适配器对发送的数据帧**不进行编号**，**也不要求对方发回确认**。这样做可以使以太网工作起来非常简单，而局域网信道的质量很好，因通信质量不好产生差错的概率是很小的。因此，**以太网提供的服务是尽最大努力交付**，即**不可靠的交付**。当目的站收到有差错的数据帧时，就把帧丢弃，其他什么也不做。**对有差错帧是否需要重传则由高层来决定**。

   我们知道，总线上只要有一台计算机在发送数据，总线的传输资源就被占用。因此，**在同一时间只能允许一台计算机发送数据**，否则各计算机之间就会互相干扰，使得所发送数据被破坏。因此，如何协调总线上各计算机的工作就是以太网要解决的一个重要问题。以太网采用最简单的随机接入，但有很好的协议来减少冲突发生的概率。

   它使用的协议是 CSMA/CD，意思是**载波监听多点接入/碰撞检测**。

2. 以太网发送的数据都使用**曼彻斯特编码**的信号。

下面介绍CSMA/CD的要点：

“**多点接入**”就是说明这是总线型网络，许多计算机以多点接入的方式连接在一根总线上。协议的实质是“载波监听”和“碰撞检测”。

“**载波监听**”就是用电子技术检测总线上有没有其他计算机也在发送。其实总线上并没有什么“载波”。载波监听就是**检测信道**。**不管在发送前，还是在发送中，每个站都必须不停地检测信道。**在发送前检测信道，是为了获得发送权。如果检测出已有其他站在发送，则自己就暂时不许发送数据，必须要等到信道变为空闲时才能发送。在发送中检测信道，是为了及时发现有没有其他站的发送和本站发送的碰撞。这就称为碰撞检测。

“**碰撞检测**”也就是“**边发送边监听**”，即适配器边发送数据边检测信道上的信号电压的变化情况，以便判断自己在发送数据时其他站也在发送数据。当几个站同时在总线上发送数据时，总线上的信号电压变化幅度将会增大。当适配器检测到的信号电压变化幅度超过一定的门限值时，就认为总线上至少有两个站在同时发送数据，表明产生了碰撞。所谓“碰撞”就是发生了冲突。因此“碰撞检测”也成为“**冲突检测**”。这时，总线上传输的信号产生了严重的失真，无法从中恢复出有用的信息来。因此，任何一个正在发送数据的站，一旦发现总线上出现了碰撞，其适配器就要立即停止发送，免得继续进行无效的发送，白白浪费网络资源，然后等待一段时间后再次发送。

发送数据后，**最迟**要经过**两倍的总线端到端的传播时延**（2$\tau$），或总线的**端到端往返传播时延**才能知道有无碰撞发生。局域网必须按总线两端的两个站之间的传播时延为端到端传播时延。

显然，在使用CSMA/CD协议时，一个站**不可能同时进行发送和接收**。因此使用CSMA/CD协议的以太网不可能进行全双工通信而只能进行**双向交替通信**。

**每一个站在自己发送数据之后的一小段时间内，存在着遭遇碰撞的可能性**。这一小段时间是**不确定的**，它取决于另一个发送数据的站到本站的距离。因此，以太网**不能保证**某一时间之内一定能够把自己的数据帧成功地发送出去。以太网的这一特点称为**发送的不确定性**。如果希望在以太网上发生碰撞的机会很小，必须使整个以太网的平均通信量远小于以太网的最高数据率。

以太网的端到端往返时间称为**争用期**，它是一个很重要的参数。争用期又称为**碰撞窗口**。这是因为一个站在发送完数据后，只有通过争用期的“考验”，即**经过争用期这段时间还没有检测到碰撞**，**才能肯定这次发送不会发生碰撞**。这时，就可以放心把这一帧数据顺利发送完毕。

以太网使用**截断二进制指数退避**算法来确定碰撞后重传的时机。

具体的退避算法如下：

1. 协议规定了基本退避时间为争用期2$\tau$，具体的**争用期时期是51.2$\mu s$。对于10Mbps以太网，在争用期内可以发送512bit。

2. 从离散的整数集合[0,1,...,($2^k-1$)]中随机取出一个数，记为r。重传应推后的时间就是r倍的争用期。

   ​													k = Min[重传次数,10]

3. 当重传达16次仍不能成功时，则丢弃该帧，并向高层报告。

当一个帧过短，可能在帧发送完毕后才检测出碰撞，但帧早已发送完毕。为了避免发生这种情况，以太网规定了一个最短帧长为512bit。如果要发送的数据非常少，那么必须加入一些填充字节，使帧长不少于64字节。

以太网在发送数据时，如果在争用期没有发生碰撞，那么后续发送的数据就一定不会发生冲突。因此**凡长度小于64字节的帧都是由于冲突而异常终止的无效帧**。

因此可以把CSMA/CD协议的要点归纳如下：

1. 准备发送：适配器从网络层获得一个分组，加上以太网的首部和尾部，组成以太网帧，放入适配器的缓存中。但在发送之前，必须**先检测信道**。

2. 检测信道：若检测到信道忙，则应不停的检测，一直等待信道转为空闲。若检测到信道空闲，并在96比特时间内信道保持空闲，就发送这个帧。

3. 在发送过程中仍不停地检测信道，即网络适配器要**边发送边监听**。这里只有两种情况：

   1. 发送成功：在争用期内一直未检测到碰撞。发送成功后什么也不做。然后回到前一大步的第一步。

   2. 发送失败：在争用期内检测到碰撞。这时立即停止发送数据，并按规定发送人为干扰信号。适配器接着就执行指数退避算法。若16次后仍不能成功，则停止重传而向上报错。

      以太网每发送完一帧，一定要把已发送的帧暂时保留一下。如果在争用期内检测出发生了碰撞，那么还要在推迟一段时间后再把这个帧重传一次。

## 4.使用广播信道的以太网

### 4.1使用集线器的星形拓扑

集线器的一些特点如下：

1. 从表面上看，使用集线器的局域网在物理上是一个星形网，但由于集线器是使用电子器件来模拟实际电缆线的工作，因此整个系统仍像一个传统以太网那样运行。也就是说，**使用集线器的以太网在逻辑上仍是一个总线网，各站共享逻辑上的总线，使用的还是CSMA/CD协议**。网络中的各站必须竞争对传输媒体的控制，并且**在同一时刻至多只允许一个站发送数据**。因此这种10BASE-T以太网又称为**星形总线**或***盒中总线**。
2. 一个集线器有许多**接口**，每个接口通过插头用两对双绞线与一个工作站上的适配器相连。因此，一个集线器很像一个**多接口的转发器**。
3. **集线器工作在物理层**，它的每个接口仅仅**简单地转发比特**，**不进行碰撞检测**。若两个接口同时有信号输入，那么所有地接口都将收不到正确的帧。
4. 集线器采用了专门的芯片，进行自适应串音回波抵消。

### 4.2以太网的信道利用率

要提高以太网的信道利用率，就必须减小 $\tau$与$T_0$之比。在以太网中定义了参数$a$，它是以太网**单程端到端时延$\tau$ **与**帧的发送时间$T_0$**之比：

​																$a=\frac{\tau}{T_0}\tag{1}$

以太网的**参数 $a$的值应当尽可能小些**。当数据率一定时，**以太网的连线的长度受到限制，**同时**以太网的帧长不能太短**。

### 4.3以太网的MAC层

#### 1.MAC层的硬件地址

**硬件地址**又称为**物理地址**或**MAC地址**

“**名字指出我们所要寻找的那个资源，地址指出那个资源在何处，路由告诉我们如何到达该处。**”

**严格的讲，名字应当与系统的所在地无关**。IEEE 802标准为局域网规定了一种48位的全球地址，是指局域网上的每一台计算机中**固化在适配器的ROM中的地址**。

在生产适配器时，MAC地址已被固化在适配器的ROM中。因此，MAC地址也叫做“**硬件地址**”或“**物理地址**”。可见，“MAC地址”实际上就是“**适配器地址**”。

适配器有**过滤功能**。适配器从网络上每收到一个MAC帧就先用硬件检查MAC帧中的目标地址。如果是发往本站的帧则收下，否则就丢弃。

发往本站的帧包括以下三种帧：

1. **单播**帧（1对1），即收到的帧的MAC地址与本站的硬件地址相同。
2. **广播**帧（1对全体），即发送给本局域网上所有站点的帧。
3. **多播**帧（1对多），即发送给本局域网上的部分站的帧。

所有的适配器都至少应该识别前两种帧，即能够识别单播和广播地址。有的适配器可用编程方法识别多播地址。

以太网适配器还可设置为一种特殊的工作方式，即**混杂方式**。工作在混杂方式的适配器只要“听到”有帧在以太网上传输就都悄悄地接收下来，而不管这些帧是发往哪个站。